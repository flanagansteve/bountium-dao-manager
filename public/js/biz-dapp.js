// TODO products don't always come back in the right order - minor issue,
// fixed any reprecussions. just aesthetic now.
// TODO allow owners to set their name in OO
// TODO implement supply step descriptions both here in adding supply step,
// and in contract's addSupplyStep
// TODO replace all "get next order/step" with async fetching
// TODO add more details to display in customer view of store:
  // info about how it is being assured for delivery (ie, guarantees)
  // info about store - their history, reviews, etc
// TODO guide biz owners on assessor setup:
  // using public incents (incorporate registrar contract):
    // level 0: suggest most popular incents
    // level 1: suggest incents based on product key words
  // guide them on deploying their own incent
// TODO cache a user's business address so that they don't have to re-enter it
// TODO darken rest of screen on popups
// TODO move all events listening for catalogue mods to one listener in the
// catalogue overview rather than within each func call
// TODO get usd prices via:
  // alphavantage: https://www.alphavantage.co/documentation/
  // key: CQ59WM0QX9LW34XT

var autobizABI = web3.eth.contract([{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"owners","outputs":[{"name":"stake","type":"uint256"},{"name":"callsDividend","type":"bool"},{"name":"canDilute","type":"bool"},{"name":"canBestow","type":"bool"},{"name":"canModifyCatalogue","type":"bool"},{"name":"board","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"product","type":"uint256"},{"name":"orderID","type":"uint256"}],"name":"checkOrderStatus","outputs":[{"name":"stepsCompleted","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"biz_name","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"catalogue","outputs":[{"name":"name","type":"string"},{"name":"description","type":"string"},{"name":"imageURL","type":"string"},{"name":"forSale","type":"bool"},{"name":"price","type":"uint256"},{"name":"ordersReceived","type":"uint256"},{"name":"supplyChainLength","type":"uint256"},{"name":"orderOptions","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"amt","type":"uint256"}],"name":"payDividend","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"product","type":"uint256"},{"name":"chosenOptions","type":"string"},{"name":"deliveryInfo","type":"string"}],"name":"order","outputs":[{"name":"orderPlaced","type":"bool"},{"name":"delivered","type":"address"},{"name":"orderID","type":"uint256"}],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[{"name":"addr","type":"address"}],"name":"isOwner","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"name":"supplyChains","outputs":[{"name":"description","type":"string"},{"name":"incentiviser","type":"address"},{"name":"fee","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"product","type":"uint256"},{"name":"orderID","type":"uint256"}],"name":"paySuppliersForOrder","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"totalShares","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"bestowee","type":"address"},{"name":"which","type":"uint256"}],"name":"bestowPermission","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"sharesToTransfer","type":"uint256"},{"name":"recipient","type":"address"}],"name":"transferShares","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"product","type":"uint256"},{"name":"step","type":"uint256"}],"name":"paySupplier","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"product","type":"uint256"}],"name":"listProduct","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"product","type":"uint256"},{"name":"options","type":"string"}],"name":"addOptions","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"product","type":"uint256"},{"name":"newPrice","type":"uint256"}],"name":"changePrice","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"product","type":"uint256"},{"name":"description_","type":"string"}],"name":"addDescription","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"},{"name":"","type":"uint256"}],"name":"orders","outputs":[{"name":"complete","type":"bool"},{"name":"suppliersPaid","type":"bool"},{"name":"deliveryInfo","type":"string"},{"name":"chosenOptions","type":"string"},{"name":"stepsCompleted","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"name","type":"string"},{"name":"price","type":"uint256"}],"name":"releaseProduct","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"product","type":"uint256"},{"name":"imageURL_","type":"string"}],"name":"addImageUrl","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"product","type":"uint256"},{"name":"evaluator","type":"address"},{"name":"fee","type":"uint256"},{"name":"instructions","type":"string"}],"name":"addSupplyStep","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"ownersRegistered","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"stake","type":"uint256"},{"name":"recipient","type":"address"}],"name":"dilute","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"product","type":"uint256"}],"name":"delistProduct","outputs":[{"name":"success","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[{"name":"_name","type":"string"}],"payable":true,"stateMutability":"payable","type":"constructor"},{"payable":false,"stateMutability":"nonpayable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":false,"name":"byWhom","type":"address"}],"name":"OwnershipModified","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"byWhom","type":"address"},{"indexed":false,"name":"productID","type":"uint256"}],"name":"ProductReleased","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"byWhom","type":"address"},{"indexed":false,"name":"productID","type":"uint256"}],"name":"ProductModified","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"productID","type":"uint256"},{"indexed":false,"name":"orderID","type":"uint256"}],"name":"OrderReceived","type":"event"}]);

autobizData = '0x608060405260a060405190810160405280606e81526020017f68747470733a2f2f7777772e6469676974616c636974697a656e2e6c6966652f81526020017f73697465732f64656661756c742f66696c65732f7374796c65732f6c73745f7381526020017f6d616c6c2f7075626c69632f66656174757265642f323031362d30382f70686f81526020017f746f5f67616c6c6572792e6a706700000000000000000000000000000000000081525060079080519060200190620000c4929190620002f7565b50604051620051993803806200519983398101806040526020811015620000ea57600080fd5b8101908080516401000000008111156200010357600080fd5b828101905060208101848111156200011a57600080fd5b81518560018202830111640100000000821117156200013857600080fd5b505092919050505060c0604051908101604052806001815260200160011515815260200160011515815260200160011515815260200160011515815260200160011515815250600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000820151816000015560208201518160010160006101000a81548160ff02191690831515021790555060408201518160010160016101000a81548160ff02191690831515021790555060608201518160010160026101000a81548160ff02191690831515021790555060808201518160010160036101000a81548160ff02191690831515021790555060a08201518160010160046101000a81548160ff02191690831515021790555090505060018081905550806000908051906020019062000289929190620002f7565b5060033390806001815401808255809150509060018203906000526020600020016000909192909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505050620003a6565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200033a57805160ff19168380011785556200036b565b828001600101855582156200036b579182015b828111156200036a5782518255916020019190600101906200034d565b5b5090506200037a91906200037e565b5090565b620003a391905b808211156200039f57600081600090555060010162000385565b5090565b90565b614de380620003b66000396000f3fe608060405260043610610138576000357c010000000000000000000000000000000000000000000000000000000090048063022914a7146101475780630491b27a146101e35780630f6168161461023c5780631e0d9560146102cc5780632515994e146104e45780632ca8bf24146105375780632f54bf6e146106e5578063306835ae1461074e57806335e5a5d0146108465780633a98ef391461088b5780634283f635146108b657806345579b1f146109295780635f833ee31461099c5780638890fe98146109e15780639081a49714610a34578063b3de019c14610b1e578063b51f79e314610b7b578063b94a000f14610c65578063bc0426ea14610dac578063bf188cc414610e96578063d2cf61ee14610f80578063e041ec0f14611094578063eedb09aa1461110f578063f07172cb14611182575b34801561014457600080fd5b50005b34801561015357600080fd5b506101966004803603602081101561016a57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506111d5565b604051808781526020018615151515815260200185151515158152602001841515151581526020018315151515815260200182151515158152602001965050505050505060405180910390f35b3480156101ef57600080fd5b506102266004803603604081101561020657600080fd5b810190808035906020019092919080359060200190929190505050611252565b6040518082815260200191505060405180910390f35b34801561024857600080fd5b506102516114a2565b6040518080602001828103825283818151815260200191508051906020019080838360005b83811015610291578082015181840152602081019050610276565b50505050905090810190601f1680156102be5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b3480156102d857600080fd5b50610305600480360360208110156102ef57600080fd5b8101908080359060200190929190505050611540565b60405180806020018060200180602001891515151581526020018881526020018781526020018681526020018060200185810385528d818151815260200191508051906020019080838360005b8381101561036d578082015181840152602081019050610352565b50505050905090810190601f16801561039a5780820380516001836020036101000a031916815260200191505b5085810384528c818151815260200191508051906020019080838360005b838110156103d35780820151818401526020810190506103b8565b50505050905090810190601f1680156104005780820380516001836020036101000a031916815260200191505b5085810383528b818151815260200191508051906020019080838360005b8381101561043957808201518184015260208101905061041e565b50505050905090810190601f1680156104665780820380516001836020036101000a031916815260200191505b50858103825286818151815260200191508051906020019080838360005b8381101561049f578082015181840152602081019050610484565b50505050905090810190601f1680156104cc5780820380516001836020036101000a031916815260200191505b509c5050505050505050505050505060405180910390f35b3480156104f057600080fd5b5061051d6004803603602081101561050757600080fd5b8101908080359060200190929190505050611804565b604051808215151515815260200191505060405180910390f35b6106916004803603606081101561054d57600080fd5b81019080803590602001909291908035906020019064010000000081111561057457600080fd5b82018360208201111561058657600080fd5b803590602001918460018302840111640100000000831117156105a857600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192908035906020019064010000000081111561060b57600080fd5b82018360208201111561061d57600080fd5b8035906020019184600183028401116401000000008311171561063f57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050611a4d565b60405180841515151581526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001828152602001935050505060405180910390f35b3480156106f157600080fd5b506107346004803603602081101561070857600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506126c7565b604051808215151515815260200191505060405180910390f35b34801561075a57600080fd5b506107916004803603604081101561077157600080fd5b810190808035906020019092919080359060200190929190505050612760565b60405180806020018473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001838152602001828103825285818151815260200191508051906020019080838360005b838110156108095780820151818401526020810190506107ee565b50505050905090810190601f1680156108365780820380516001836020036101000a031916815260200191505b5094505050505060405180910390f35b34801561085257600080fd5b506108896004803603604081101561086957600080fd5b81019080803590602001909291908035906020019092919050505061285e565b005b34801561089757600080fd5b506108a0612b39565b6040518082815260200191505060405180910390f35b3480156108c257600080fd5b5061090f600480360360408110156108d957600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190505050612b3f565b604051808215151515815260200191505060405180910390f35b34801561093557600080fd5b506109826004803603604081101561094c57600080fd5b8101908080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050612f5a565b604051808215151515815260200191505060405180910390f35b3480156109a857600080fd5b506109df600480360360408110156109bf57600080fd5b81019080803590602001909291908035906020019092919050505061310f565b005b3480156109ed57600080fd5b50610a1a60048036036020811015610a0457600080fd5b81019080803590602001909291905050506132ce565b604051808215151515815260200191505060405180910390f35b348015610a4057600080fd5b50610b0460048036036040811015610a5757600080fd5b810190808035906020019092919080359060200190640100000000811115610a7e57600080fd5b820183602082011115610a9057600080fd5b80359060200191846001830284011164010000000083111715610ab257600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050613473565b604051808215151515815260200191505060405180910390f35b348015610b2a57600080fd5b50610b6160048036036040811015610b4157600080fd5b810190808035906020019092919080359060200190929190505050613615565b604051808215151515815260200191505060405180910390f35b348015610b8757600080fd5b50610c4b60048036036040811015610b9e57600080fd5b810190808035906020019092919080359060200190640100000000811115610bc557600080fd5b820183602082011115610bd757600080fd5b80359060200191846001830284011164010000000083111715610bf957600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192905050506137a7565b604051808215151515815260200191505060405180910390f35b348015610c7157600080fd5b50610ca860048036036040811015610c8857600080fd5b810190808035906020019092919080359060200190929190505050613949565b6040518086151515158152602001851515151581526020018060200180602001848152602001838103835286818151815260200191508051906020019080838360005b83811015610d06578082015181840152602081019050610ceb565b50505050905090810190601f168015610d335780820380516001836020036101000a031916815260200191505b50838103825285818151815260200191508051906020019080838360005b83811015610d6c578082015181840152602081019050610d51565b50505050905090810190601f168015610d995780820380516001836020036101000a031916815260200191505b5097505050505050505060405180910390f35b348015610db857600080fd5b50610e7c60048036036040811015610dcf57600080fd5b8101908080359060200190640100000000811115610dec57600080fd5b820183602082011115610dfe57600080fd5b80359060200191846001830284011164010000000083111715610e2057600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f82011690508083019250505050505050919291929080359060200190929190505050613ae5565b604051808215151515815260200191505060405180910390f35b348015610ea257600080fd5b50610f6660048036036040811015610eb957600080fd5b810190808035906020019092919080359060200190640100000000811115610ee057600080fd5b820183602082011115610ef257600080fd5b80359060200191846001830284011164010000000083111715610f1457600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f820116905080830192505050505050509192919290505050613f03565b604051808215151515815260200191505060405180910390f35b348015610f8c57600080fd5b5061107a60048036036080811015610fa357600080fd5b8101908080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035906020019092919080359060200190640100000000811115610ff457600080fd5b82018360208201111561100657600080fd5b8035906020019184600183028401116401000000008311171561102857600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600081840152601f19601f8201169050808301925050505050505091929192905050506140a5565b604051808215151515815260200191505060405180910390f35b3480156110a057600080fd5b506110cd600480360360208110156110b757600080fd5b81019080803590602001909291905050506144a5565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561111b57600080fd5b506111686004803603604081101561113257600080fd5b8101908080359060200190929190803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506144e3565b604051808215151515815260200191505060405180910390f35b34801561118e57600080fd5b506111bb600480360360208110156111a557600080fd5b8101908080359060200190929190505050614662565b604051808215151515815260200191505060405180910390f35b60026020528060005260406000206000915090508060000154908060010160009054906101000a900460ff16908060010160019054906101000a900460ff16908060010160029054906101000a900460ff16908060010160039054906101000a900460ff16908060010160049054906101000a900460ff16905086565b60008060008090505b60048581548110151561126a57fe5b90600052602060002090600a0201600801805490508110156114975760008060048781548110151561129857fe5b90600052602060002090600a0201600801838154811015156112b657fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16637dc0d1d06040518163ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040160206040518083038186803b15801561134257600080fd5b505afa158015611356573d6000803e3d6000fd5b505050506040513d602081101561136c57600080fd5b810190808051906020019092919050505073ffffffffffffffffffffffffffffffffffffffff1663c0cca5ef600560008a8152602001908152602001600020888154811015156113b857fe5b9060005260206000209060050201600401858154811015156113d657fe5b90600052602060002001546040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180828152602001915050604080518083038186803b15801561143057600080fd5b505afa158015611444573d6000803e3d6000fd5b505050506040513d604081101561145a57600080fd5b8101908080519060200190929190805190602001909291905050509150915081156114885783806001019450505b5050808060010191505061125b565b508091505092915050565b60008054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156115385780601f1061150d57610100808354040283529160200191611538565b820191906000526020600020905b81548152906001019060200180831161151b57829003601f168201915b505050505081565b60048181548110151561154f57fe5b90600052602060002090600a0201600091509050806000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156115fb5780601f106115d0576101008083540402835291602001916115fb565b820191906000526020600020905b8154815290600101906020018083116115de57829003601f168201915b505050505090806001018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156116995780601f1061166e57610100808354040283529160200191611699565b820191906000526020600020905b81548152906001019060200180831161167c57829003601f168201915b505050505090806002018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156117375780601f1061170c57610100808354040283529160200191611737565b820191906000526020600020905b81548152906001019060200180831161171a57829003601f168201915b5050505050908060030160009054906101000a900460ff1690806004015490806005015490806006015490806007018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156117fa5780601f106117cf576101008083540402835291602001916117fa565b820191906000526020600020905b8154815290600101906020018083116117dd57829003601f168201915b5050505050905088565b6000611896600380548060200260200160405190810160405280929190818152602001828054801561188b57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311611841575b505050505033614807565b15156118a157600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160009054906101000a900460ff1615156118fc57600080fd5b60015482023073ffffffffffffffffffffffffffffffffffffffff16311015151561192657600080fd5b60008090505b600380549050811015611a435760038181548110151561194857fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc6002600060038581548110151561199f57fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000015485029081150290604051600060405180830381858888f19350505050158015611a35573d6000803e3d6000fd5b50808060010191505061192c565b5060019050919050565b6000806000600486815481101515611a6157fe5b90600052602060002090600a0201600401543410151515611a8157600080fd5b600486815481101515611a9057fe5b90600052602060002090600a020160030160009054906101000a900460ff161515611aba57600080fd5b6005600087815260200190815260200160002060c060405190810160405280600015158152602001600015158152602001868152602001878152602001600081526020016000604051908082528060200260200182016040528015611b2e5781602001602082028038833980820191505090505b508152509080600181540180825580915050906001820390600052602060002090600502016000909192909190915060008201518160000160006101000a81548160ff02191690831515021790555060208201518160000160016101000a81548160ff0219169083151502179055506040820151816001019080519060200190611bb9929190614b78565b506060820151816002019080519060200190611bd6929190614b78565b506080820151816003015560a0820151816004019080519060200190611bfd929190614bf8565b505050506000600487815481101515611c1257fe5b90600052602060002090600a020160080180549050111561244c5760008090505b6001600488815481101515611c4457fe5b90600052602060002090600a0201600801805490500381101561202357600080600489815481101515611c7357fe5b90600052602060002090600a020160080183815481101515611c9157fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16637dc0d1d06040518163ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040160206040518083038186803b158015611d1d57600080fd5b505afa158015611d31573d6000803e3d6000fd5b505050506040513d6020811015611d4757600080fd5b810190808051906020019092919050505073ffffffffffffffffffffffffffffffffffffffff1663ef7fa71b611d84611d7f8b614886565b6148b2565b6040518263ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018080602001828103825283818151815260200191508051906020019080838360005b83811015611def578082015181840152602081019050611dd4565b50505050905090810190601f168015611e1c5780820380516001836020036101000a031916815260200191505b50925050506040805180830381600087803b158015611e3a57600080fd5b505af1158015611e4e573d6000803e3d6000fd5b505050506040513d6040811015611e6457600080fd5b81019080805190602001909291908051906020019092919050505091509150600560008a815260200190815260200160002060048a815481101515611ea557fe5b90600052602060002090600a020160050154815481101515611ec357fe5b9060005260206000209060050201600401819080600181540180825580915050906001820390600052602060002001600090919290919091505550600489815481101515611f0d57fe5b90600052602060002090600a020160080183815481101515611f2b57fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663ca1d209d60048b815481101515611f8057fe5b90600052602060002090600a020160090185815481101515611f9e57fe5b9060005260206000200154836040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808281526020019150506000604051808303818588803b158015611ffb57600080fd5b505af115801561200f573d6000803e3d6000fd5b505050505050508080600101915050611c33565b5060008060048881548110151561203657fe5b90600052602060002090600a0201600801600160048a81548110151561205857fe5b90600052602060002090600a0201600801805490500381548110151561207a57fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16637dc0d1d06040518163ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040160206040518083038186803b15801561210657600080fd5b505afa15801561211a573d6000803e3d6000fd5b505050506040513d602081101561213057600080fd5b810190808051906020019092919050505073ffffffffffffffffffffffffffffffffffffffff1663ef7fa71b61216d61216889614886565b6148b2565b6040518263ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018080602001828103825283818151815260200191508051906020019080838360005b838110156121d85780820151818401526020810190506121bd565b50505050905090810190601f1680156122055780820380516001836020036101000a031916815260200191505b50925050506040805180830381600087803b15801561222357600080fd5b505af1158015612237573d6000803e3d6000fd5b505050506040513d604081101561224d57600080fd5b810190808051906020019092919080519060200190929190505050915091506005600089815260200190815260200160002060048981548110151561228e57fe5b90600052602060002090600a0201600501548154811015156122ac57fe5b90600052602060002090600502016004018190806001815401808255809150509060018203906000526020600020016000909192909190915055506004888154811015156122f657fe5b90600052602060002090600a0201600801600160048a81548110151561231857fe5b90600052602060002090600a0201600801805490500381548110151561233a57fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663ca1d209d60048a81548110151561238f57fe5b90600052602060002090600a0201600901600160048c8154811015156123b157fe5b90600052602060002090600a020160090180549050038154811015156123d357fe5b9060005260206000200154836040518363ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808281526020019150506000604051808303818588803b15801561243057600080fd5b505af1158015612444573d6000803e3d6000fd5b505050505050505b60048681548110151561245b57fe5b90600052602060002090600a0201600501600081548092919060010191905055507fba9c45564c5c793c4707a33284ffb08787d2ff6f022bb1a8eff0a7fb72b495098660016004898154811015156124af57fe5b90600052602060002090600a02016005015403604051808381526020018281526020019250505060405180910390a160006004878154811015156124ef57fe5b90600052602060002090600a02016008018054905014151561265657600160048781548110151561251c57fe5b90600052602060002090600a0201600801600160048981548110151561253e57fe5b90600052602060002090600a0201600801805490500381548110151561256057fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16637dc0d1d06040518163ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040160206040518083038186803b1580156125ec57600080fd5b505afa158015612600573d6000803e3d6000fd5b505050506040513d602081101561261657600080fd5b8101908080519060200190929190505050600160048981548110151561263857fe5b90600052602060002090600a020160050154039250925092506126be565b60016003600081548110151561266857fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016004898154811015156126a457fe5b90600052602060002090600a020160050154039250925092505b93509350939050565b6000612759600380548060200260200160405190810160405280929190818152602001828054801561274e57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311612704575b505050505083614807565b9050919050565b60066020528160005260406000208181548110151561277b57fe5b906000526020600020906003020160009150915050806000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156128285780601f106127fd57610100808354040283529160200191612828565b820191906000526020600020905b81548152906001019060200180831161280b57829003601f168201915b5050505050908060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020154905083565b60008090505b60048381548110151561287357fe5b90600052602060002090600a020160080180549050811015612a325760006004848154811015156128a057fe5b90600052602060002090600a0201600801828154811015156128be57fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16638df82800600560008781526020019081526020016000208581548110151561292457fe5b90600052602060002090600502016004018481548110151561294257fe5b90600052602060002001546040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180828152602001915050602060405180830381600087803b15801561299f57600080fd5b505af11580156129b3573d6000803e3d6000fd5b505050506040513d60208110156129c957600080fd5b810190808051906020019092919050505090508015612a24576005600085815260200190815260200160002083815481101515612a0257fe5b9060005260206000209060050201600301600081548092919060010191905055505b508080600101915050612864565b506005600083815260200190815260200160002081815481101515612a5357fe5b9060005260206000209060050201600401805490506005600084815260200190815260200160002082815481101515612a8857fe5b9060005260206000209060050201600301541415612b355760016005600084815260200190815260200160002082815481101515612ac257fe5b906000526020600020906005020160000160006101000a81548160ff02191690831515021790555060016005600084815260200190815260200160002082815481101515612b0c57fe5b906000526020600020906005020160000160016101000a81548160ff0219169083151502179055505b5050565b60015481565b6000612bd16003805480602002602001604051908101604052809291908181526020018280548015612bc657602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311612b7c575b505050505033614807565b1515612bdc57600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160029054906101000a900460ff161515612c3757600080fd5b612cc76003805480602002602001604051908101604052809291908181526020018280548015612cbc57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311612c72575b505050505084614807565b1515612cd257600080fd5b6001821415612d3b576001600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160006101000a81548160ff021916908315150217905550612eec565b6002821415612da4576001600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160016101000a81548160ff021916908315150217905550612eeb565b6003821415612e0d576001600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160026101000a81548160ff021916908315150217905550612eea565b6004821415612e76576001600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160036101000a81548160ff021916908315150217905550612ee9565b6005821415612edf576001600260008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160046101000a81548160ff021916908315150217905550612ee8565b60009050612f54565b5b5b5b5b7fd5d95ef604484497eaeec7fad05891c7932bf086598f9f40e5f40069e1c92fb133604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a1600190505b92915050565b6000612fec6003805480602002602001604051908101604052809291908181526020018280548015612fe157602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311612f97575b505050505033614807565b1515612ff757600080fd5b82600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001541015151561304857600080fd5b82600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001600082825403925050819055506130a283836148f9565b7fd5d95ef604484497eaeec7fad05891c7932bf086598f9f40e5f40069e1c92fb133604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a16001905092915050565b8060048381548110151561311f57fe5b90600052602060002090600a02016008018054905011151561314057600080fd5b60008090505b60048381548110151561315557fe5b90600052602060002090600a0201600501548110156132c957600060048481548110151561317f57fe5b90600052602060002090600a02016008018381548110151561319d57fe5b9060005260206000200160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16638df82800600560008781526020019081526020016000208481548110151561320357fe5b90600052602060002090600502016004018581548110151561322157fe5b90600052602060002001546040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180828152602001915050602060405180830381600087803b15801561327e57600080fd5b505af1158015613292573d6000803e3d6000fd5b505050506040513d60208110156132a857600080fd5b81019080805190602001909291905050509050508080600101915050613146565b505050565b6000613360600380548060200260200160405190810160405280929190818152602001828054801561335557602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001906001019080831161330b575b505050505033614807565b151561336b57600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160039054906101000a900460ff1615156133c657600080fd5b60016004838154811015156133d757fe5b90600052602060002090600a020160030160006101000a81548160ff0219169083151502179055507fea119b5d1c53331dc8e815bae5f38192a8a4660f1959c1c0ed6e21710c0539b13383604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a160019050919050565b600061350560038054806020026020016040519081016040528092919081815260200182805480156134fa57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190600101908083116134b0575b505050505033614807565b151561351057600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160039054906101000a900460ff16151561356b57600080fd5b8160048481548110151561357b57fe5b90600052602060002090600a0201600701908051906020019061359f929190614c45565b507fea119b5d1c53331dc8e815bae5f38192a8a4660f1959c1c0ed6e21710c0539b13384604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a16001905092915050565b60006136a7600380548060200260200160405190810160405280929190818152602001828054801561369c57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311613652575b505050505033614807565b15156136b257600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160039054906101000a900460ff16151561370d57600080fd5b8160048481548110151561371d57fe5b90600052602060002090600a0201600401819055507fea119b5d1c53331dc8e815bae5f38192a8a4660f1959c1c0ed6e21710c0539b13384604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a16001905092915050565b6000613839600380548060200260200160405190810160405280929190818152602001828054801561382e57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190600101908083116137e4575b505050505033614807565b151561384457600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160039054906101000a900460ff16151561389f57600080fd5b816004848154811015156138af57fe5b90600052602060002090600a020160010190805190602001906138d3929190614c45565b507fea119b5d1c53331dc8e815bae5f38192a8a4660f1959c1c0ed6e21710c0539b13384604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a16001905092915050565b60056020528160005260406000208181548110151561396457fe5b9060005260206000209060050201600091509150508060000160009054906101000a900460ff16908060000160019054906101000a900460ff1690806001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015613a375780601f10613a0c57610100808354040283529160200191613a37565b820191906000526020600020905b815481529060010190602001808311613a1a57829003601f168201915b505050505090806002018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015613ad55780601f10613aaa57610100808354040283529160200191613ad5565b820191906000526020600020905b815481529060010190602001808311613ab857829003601f168201915b5050505050908060030154905085565b6000613b776003805480602002602001604051908101604052809291908181526020018280548015613b6c57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311613b22575b505050505033614807565b1515613b8257600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160039054906101000a900460ff161515613bdd57600080fd5b6004610140604051908101604052808581526020016040805190810160405280601281526020017f4e6f206465736372697074696f6e207365740000000000000000000000000000815250815260200160078054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015613cc35780601f10613c9857610100808354040283529160200191613cc3565b820191906000526020600020905b815481529060010190602001808311613ca657829003601f168201915b505050505081526020016000151581526020018481526020016000815260200160008152602001602060405190810160405280600081525081526020016000604051908082528060200260200182016040528015613d305781602001602082028038833980820191505090505b5081526020016000604051908082528060200260200182016040528015613d665781602001602082028038833980820191505090505b508152509080600181540180825580915050906001820390600052602060002090600a0201600090919290919091506000820151816000019080519060200190613db1929190614b78565b506020820151816001019080519060200190613dce929190614b78565b506040820151816002019080519060200190613deb929190614b78565b5060608201518160030160006101000a81548160ff0219169083151502179055506080820151816004015560a0820151816005015560c0820151816006015560e0820151816007019080519060200190613e46929190614b78565b50610100820151816008019080519060200190613e64929190614cc5565b50610120820151816009019080519060200190613e82929190614bf8565b505050507fe0504cc164285e97b36a9f9f435e8141dc6de53f51be25d0b2897704c469f0b233600160048054905003604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a16001905092915050565b6000613f956003805480602002602001604051908101604052809291908181526020018280548015613f8a57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311613f40575b505050505033614807565b1515613fa057600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160039054906101000a900460ff161515613ffb57600080fd5b8160048481548110151561400b57fe5b90600052602060002090600a0201600201908051906020019061402f929190614c45565b507fea119b5d1c53331dc8e815bae5f38192a8a4660f1959c1c0ed6e21710c0539b13384604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a16001905092915050565b6000614137600380548060200260200160405190810160405280929190818152602001828054801561412c57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190600101908083116140e2575b505050505033614807565b151561414257600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160039054906101000a900460ff16151561419d57600080fd5b600080905060008090505b6004878154811015156141b757fe5b90600052602060002090600a02016009018054905081101561421c576004878154811015156141e257fe5b90600052602060002090600a02016009018181548110151561420057fe5b90600052602060002001548201915080806001019150506141a8565b5060048681548110151561422c57fe5b90600052602060002090600a0201600401548482011115151561424e57600080fd5b60048681548110151561425d57fe5b90600052602060002090600a02016008018590806001815401808255809150509060018203906000526020600020016000909192909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550506004868154811015156142e157fe5b90600052602060002090600a020160090184908060018154018082558091505090600182039060005260206000200160009091929091909150555060048681548110151561432b57fe5b90600052602060002090600a020160060160008154809291906001019190505550600660008781526020019081526020016000206060604051908101604052808581526020018773ffffffffffffffffffffffffffffffffffffffff168152602001868152509080600181540180825580915050906001820390600052602060002090600302016000909192909190915060008201518160000190805190602001906143d8929190614b78565b5060208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550604082015181600201555050507fea119b5d1c53331dc8e815bae5f38192a8a4660f1959c1c0ed6e21710c0539b13387604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a16001915050949350505050565b6003818154811015156144b457fe5b906000526020600020016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b6000614575600380548060200260200160405190810160405280929190818152602001828054801561456a57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311614520575b505050505033614807565b151561458057600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160019054906101000a900460ff1615156145db57600080fd5b826001600082825401925050819055506145f583836148f9565b7fd5d95ef604484497eaeec7fad05891c7932bf086598f9f40e5f40069e1c92fb133604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a16001905092915050565b60006146f460038054806020026020016040519081016040528092919081815260200182805480156146e957602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001906001019080831161469f575b505050505033614807565b15156146ff57600080fd5b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060010160039054906101000a900460ff16151561475a57600080fd5b600060048381548110151561476b57fe5b90600052602060002090600a020160030160006101000a81548160ff0219169083151502179055507fea119b5d1c53331dc8e815bae5f38192a8a4660f1959c1c0ed6e21710c0539b13383604051808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281526020019250505060405180910390a160019050919050565b600080600090505b835181101561487a578273ffffffffffffffffffffffffffffffffffffffff16848281518110151561483d57fe5b9060200190602002015173ffffffffffffffffffffffffffffffffffffffff16141561486d576001915050614880565b808060010191505061480f565b50600090505b92915050565b600060608290506000815114156148a45760006001029150506148ad565b60208301519150505b919050565b606060206040519080825280601f01601f1916602001820160405280156148e85781602001600182028038833980820191505090505b509050816020820152809050919050565b614989600380548060200260200160405190810160405280929190818152602001828054801561497e57602002820191906000526020600020905b8160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019060010190808311614934575b505050505082614807565b1515614b235760c06040519081016040528083815260200160001515815260200160001515815260200160001515815260200160001515815260200160001515815250600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000820151816000015560208201518160010160006101000a81548160ff02191690831515021790555060408201518160010160016101000a81548160ff02191690831515021790555060608201518160010160026101000a81548160ff02191690831515021790555060808201518160010160036101000a81548160ff02191690831515021790555060a08201518160010160046101000a81548160ff02191690831515021790555090505060038190806001815401808255809150509060018203906000526020600020016000909192909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050614b74565b81600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600001600082825401925050819055505b5050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10614bb957805160ff1916838001178555614be7565b82800160010185558215614be7579182015b82811115614be6578251825591602001919060010190614bcb565b5b509050614bf49190614d4f565b5090565b828054828255906000526020600020908101928215614c34579160200282015b82811115614c33578251825591602001919060010190614c18565b5b509050614c419190614d4f565b5090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10614c8657805160ff1916838001178555614cb4565b82800160010185558215614cb4579182015b82811115614cb3578251825591602001919060010190614c98565b5b509050614cc19190614d4f565b5090565b828054828255906000526020600020908101928215614d3e579160200282015b82811115614d3d5782518260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555091602001919060010190614ce5565b5b509050614d4b9190614d74565b5090565b614d7191905b80821115614d6d576000816000905550600101614d55565b5090565b90565b614db491905b80821115614db057600081816101000a81549073ffffffffffffffffffffffffffffffffffffffff021916905550600101614d7a565b5090565b9056fea165627a7a72305820f5ec6eaa3410ae321c5ad6f9d0247c55f448ef336f8c4aface4efcd94915844d0029';

autobizAddr = null;

autobiz = null;

window.addEventListener('load', async () => {

  document.getElementById("dashboard").innerHTML = "<h1>Bountium is a dapp built on the Ethereum blockchain. You need an Ethereum wallet to use it - we recommend metamask, which you can install <a href = \'https://metamask.io\'>here</a></h1>";
  ReactDOM.render(
    React.createElement(Navbar, {}),
    document.getElementById("navbar")
  );

  // check for metamask
  if(typeof web3 !== 'undefined') {
    await ethereum.enable();
    web3 = new Web3(web3.currentProvider);
  } else {
    web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
  }
  try {
    userAccount = web3.eth.accounts[0];
    updateInterface();
    var accountInterval = setInterval(function() {
      if (web3.eth.accounts[0] !== userAccount) {
        userAccount = web3.eth.accounts[0];
        updateInterface();
      }
    }, 100);
  } catch (e) {
    console.error(e);
  }
});

function updateInterface() {
  document.getElementById("workflow-container").innerHTML = "";
  var addr = location.search;
  if (addr.includes("0x")) {
    autobizAddr = addr.substring(addr.indexOf("0x"));
    // presuming its a valid autobiz addr... TODO
    autobiz = autobizABI.at(autobizAddr);
    renderDashboard();
  } else {
    ReactDOM.render(
      React.createElement(Welcome, null, userAccount),
      document.getElementById("dashboard")
    );
  }
}

var Welcome = React.createClass({

  newBiz : function() {
    newBizWorkflow();
  },

  renderDashboard : function () {
    autobizAddr = document.getElementById("autobiz-addr-input").value;
    autobiz = autobizABI.at(autobizAddr);
    renderDashboard();
  },

  render : function() {
    var br = React.createElement("br", {});
    return React.createElement("div", {className:"container-fluid"},
      React.createElement("div", {className:"autobiz-addr-form"},
        React.createElement("h3", {}, "Manage my Bountium-powered business"),
        React.createElement("input", {type:"text", id:"autobiz-addr-input", className:"form-control col-8", placeholder:"Your Autobiz's address"}),
        React.createElement("button", {className:"btn btn-primary mt-2",id:"autobiz-addr-input-btn", onClick:this.renderDashboard}, "Go!")
      )
    )
  }
})

function renderDashboard() {
  autobiz.isOwner(userAccount, function(err, res) {
    if (res) {
      document.getElementById("dashboard").innerHTML = "";
      ReactDOM.render(
        React.createElement(Dashboard, null, userAccount),
        document.getElementById("dashboard")
      );
    } else {
      alert("You are not registered as an owner of that business - double check that you are using the same account in Metamask as the one you used to create this business (or, the account that a previous owner allocated your shares to)");
    }
  });
}

var Dashboard = React.createClass({

  getInitialState : function() {
    return {
      viewingOrg : true,
      viewingProducts : false,
      viewingOps : false,
      viewingChat : false,
      bizName : "anonymous business"
    }
  },

  componentDidMount : function() {
    autobiz.biz_name((err, res) => {
      if (res!="")
        this.setState({bizName : res});
    });
  },

  viewProducts : function() {
    this.setState({viewingProducts : true});
    this.setState({viewingOrg : false});
    this.setState({viewingOps : false});
    this.setState({viewingChat : false});
  },

  viewOrg : function() {
    this.setState({viewingProducts : false});
    this.setState({viewingOrg : true});
    this.setState({viewingOps : false});
    this.setState({viewingChat : false});
  },

  viewOps : function() {
    this.setState({viewingProducts : false});
    this.setState({viewingOrg : false});
    this.setState({viewingOps : true});
    this.setState({viewingChat : false});
  },

  viewChat : function() {
    this.setState({viewingProducts : false});
    this.setState({viewingOrg : false});
    this.setState({viewingOps : false});
    this.setState({viewingChat : true});
  },

  render : function() {
    var managerNavbar = React.createElement("div", {},
        React.createElement("ul", {className:"nav navbar"},
          React.createElement("li", {className:"nav-item display-4 col-3" + (this.state.viewingOrg ? " border-bottom" : ""), onClick:this.viewOrg},
            React.createElement("h4", {className:"text-center"}, "Organisation")
          ),
          React.createElement("li", {className:"nav-item display-4 col-3" + (this.state.viewingProducts ? " border-bottom" : ""), onClick:this.viewProducts},
            React.createElement("h4", {className:"text-center"}, "Products")
          ),
          React.createElement("li", {className:"nav-item display-4 col-3" + (this.state.viewingOps ? " border-bottom" : ""), onClick:this.viewOps},
            React.createElement("h4", {className:"text-center"}, "Operations")
          ),
          React.createElement("li", {className:"nav-item display-4 col-3" + (this.state.viewingChat ? " border-bottom" : ""), onClick:this.viewChat},
            React.createElement("h4", {className:"text-center"}, "Chat")
          )
        )
      )
    return React.createElement("div", {className:"container-fluid"},
      React.createElement("div", {className:"row mb-2"},
        React.createElement("h3", {className:"ml-5"}, "Managing: " + this.state.bizName),
        React.createElement("a", {className:"btn btn-primary ml-auto mr-5", href:"http://shop.bountium.org/?" + autobiz.address, target:"_blank"}, "View My Store"),
      ),
      managerNavbar,
      this.state.viewingOrg && React.createElement(OrgOverview, {autobiz:autobiz}),
      this.state.viewingProducts && React.createElement(CatalogueOverview, {autobiz:autobiz}),
      this.state.viewingOps && React.createElement(OpsOveriew, {autobiz:autobiz}),
      this.state.viewingChat && React.createElement(CollabOverview, {autobiz:autobiz})
    );
  }

});

function renderNotOwnerError() {
  ReactDOM.render(
    React.createElement(NotOwnerError, {}),
    document.getElementById("dashboard")
  );
};

// Override alert function to use _B_ootstrap
window.alert = function(text) {
  ReactDOM.render(
    React.createElement("div", {className:"alert alert-warning alert-dismissible fixed-top zindex-popover", role:"alert", id:"to-dismiss"},
      text,
      React.createElement("button", {
        type:"button",
        className:"close",
        dataDismiss:"alert",
        ariaLabel:"Close",
        onClick:function() { document.getElementById("to-dismiss").remove() }
      }, React.createElement("span", {ariaHidden:"true"}, "x"))
    ),
    document.getElementById("workflow-container")
  );
}
